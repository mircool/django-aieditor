{% load static %}
<textarea name="{{ widget.name }}"{% include "django/forms/widgets/attrs.html" %}>{% if widget.value %}{{ widget.value }}{% endif %}</textarea>
<script>
    // 将Django配置转换为JavaScript对象
    var editorConfig = {
        {% for key, value in widget.config.items %}
            "{{ key }}": {{ value|safe }},
        {% endfor %}
    };
</script>
<script type="module">
    import { AiEditor } from "{% static 'django_aieditor/js/index.js' %}";
    document.addEventListener('DOMContentLoaded', function() {
        const config = {
            element: document.querySelector('[name="{{ widget.name }}"]'),
            ...window.editorConfig
        };
        if (config.element) {
            new AiEditor(config);
        }
    });
</script> 